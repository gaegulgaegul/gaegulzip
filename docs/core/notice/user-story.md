# 사용자 스토리: 공지사항 (Notice)

## 개요

모든 제품(앱)에서 공통으로 사용할 수 있는 공지사항 기능입니다. 관리자는 앱별로 공지사항을 작성하고 관리할 수 있으며, 사용자는 자신이 사용하는 앱의 공지사항을 조회하고 읽을 수 있습니다. 멀티테넌트 구조를 지원하여 여러 제품이 하나의 시스템을 공유하면서도 데이터를 격리할 수 있습니다.

### 범위 결정사항
- **관리자 CRUD(작성/수정/삭제/고정)**: 서버 API만 제공 (모바일 SDK에 관리자 UI 미포함)
- **모바일 SDK**: 사용자 조회 기능만 포함 (목록, 상세, 읽음 처리, 안 읽은 개수)
- 관리자 화면은 별도 어드민 웹/대시보드에서 API를 호출하여 사용

## 사용자 스토리

### US-1: 공지사항 목록 조회
- **As a** 앱 사용자
- **I want to** 내가 사용하는 앱의 공지사항 목록을 볼 수 있다
- **So that** 새로운 소식, 업데이트, 점검 정보 등을 확인할 수 있다

### US-2: 공지사항 상세 조회
- **As a** 앱 사용자
- **I want to** 공지사항의 전체 내용을 자세히 볼 수 있다
- **So that** 공지사항의 구체적인 정보를 파악할 수 있다

### US-3: 읽음 처리
- **As a** 앱 사용자
- **I want to** 내가 읽은 공지사항이 읽음으로 표시되길 원한다
- **So that** 어떤 공지사항을 이미 읽었는지 구분할 수 있다

### US-4: 읽지 않은 공지사항 확인
- **As a** 앱 사용자
- **I want to** 읽지 않은 공지사항의 개수를 확인할 수 있다
- **So that** 새로운 공지사항이 있는지 빠르게 파악할 수 있다

### US-5: 고정 공지사항
- **As a** 앱 사용자
- **I want to** 중요한 공지사항이 목록 상단에 고정되어 표시되길 원한다
- **So that** 중요한 정보를 놓치지 않을 수 있다

### US-6: 공지사항 작성
- **As a** 앱 관리자
- **I want to** 새로운 공지사항을 작성할 수 있다
- **So that** 사용자에게 전달할 정보를 게시할 수 있다

### US-7: 공지사항 수정
- **As a** 앱 관리자
- **I want to** 작성한 공지사항을 수정할 수 있다
- **So that** 잘못된 정보를 바로잡거나 내용을 보완할 수 있다

### US-8: 공지사항 삭제
- **As a** 앱 관리자
- **I want to** 더 이상 필요하지 않은 공지사항을 삭제할 수 있다
- **So that** 불필요한 정보로 사용자를 혼란스럽게 하지 않을 수 있다

### US-9: 공지사항 고정/해제
- **As a** 앱 관리자
- **I want to** 공지사항을 상단에 고정하거나 해제할 수 있다
- **So that** 중요한 공지사항을 사용자에게 우선적으로 노출할 수 있다

### US-10: 앱별 공지사항 분리
- **As a** 시스템 운영자
- **I want to** 각 앱의 공지사항이 독립적으로 관리되길 원한다
- **So that** 여러 제품이 하나의 시스템을 공유하면서도 데이터를 격리할 수 있다

---

## 사용자 시나리오

### 시나리오 1: 사용자가 공지사항 목록을 조회하는 정상 플로우
1. 사용자가 앱의 공지사항 화면에 진입한다
2. 시스템이 사용자의 앱에 해당하는 공지사항 목록을 불러온다
3. 시스템이 고정된 공지사항을 목록 상단에 표시한다
4. 시스템이 각 공지사항에 읽음/읽지 않음 상태를 표시한다
5. 사용자가 공지사항 목록을 스크롤하며 확인한다
6. 결과: 사용자가 최신 공지사항과 중요 공지사항을 확인할 수 있다

### 시나리오 2: 사용자가 공지사항 상세를 조회하는 플로우
1. 사용자가 공지사항 목록에서 하나를 선택한다
2. 시스템이 공지사항 상세 내용을 표시한다
3. 시스템이 조회수를 1 증가시킨다
4. 시스템이 해당 공지사항을 읽음으로 처리한다
5. 사용자가 본문 내용을 스크롤하며 읽는다
6. 결과: 사용자가 공지사항의 전체 내용을 이해하고, 읽음 상태가 기록된다

### 시나리오 3: 사용자가 읽지 않은 공지사항을 확인하는 플로우
1. 사용자가 앱의 메인 화면에 있다
2. 시스템이 읽지 않은 공지사항 개수를 계산한다
3. 시스템이 공지사항 메뉴에 뱃지로 읽지 않은 개수를 표시한다
4. 사용자가 뱃지를 보고 새 공지사항이 있음을 인지한다
5. 사용자가 공지사항 화면으로 이동한다
6. 결과: 사용자가 새로운 공지사항을 확인하도록 유도된다

### 시나리오 4: 관리자가 새 공지사항을 작성하는 플로우
1. 관리자가 관리자 도구에서 공지사항 작성 화면에 진입한다
2. 관리자가 제목을 입력한다
3. 관리자가 본문을 작성한다 (마크다운 지원)
4. 관리자가 카테고리를 선택한다 (선택사항)
5. 관리자가 상단 고정 여부를 설정한다
6. 관리자가 저장 버튼을 누른다
7. 시스템이 입력값을 검증한다
8. 시스템이 공지사항을 생성하고 공개 상태로 설정한다
9. 결과: 새 공지사항이 사용자에게 표시된다

### 시나리오 5: 관리자가 공지사항을 수정하는 플로우
1. 관리자가 기존 공지사항 목록에서 하나를 선택한다
2. 관리자가 수정 화면에 진입한다
3. 시스템이 기존 데이터를 폼에 채워준다
4. 관리자가 제목, 본문, 카테고리, 고정 여부 등을 수정한다
5. 관리자가 저장 버튼을 누른다
6. 시스템이 변경사항을 검증한다
7. 시스템이 수정 시간을 업데이트한다
8. 결과: 공지사항이 수정된 내용으로 사용자에게 표시된다

### 시나리오 6: 관리자가 공지사항을 삭제하는 플로우
1. 관리자가 기존 공지사항 목록에서 하나를 선택한다
2. 관리자가 삭제 버튼을 누른다
3. 시스템이 삭제 확인 메시지를 표시한다
4. 관리자가 삭제를 확인한다
5. 시스템이 공지사항을 삭제 처리한다 (복구 가능하도록 보관)
6. 시스템이 공지사항 목록을 갱신한다
7. 결과: 해당 공지사항이 사용자에게 더 이상 표시되지 않는다

### 시나리오 7: 멀티테넌트 환경에서 앱별 공지사항 분리
1. 사용자 A가 "wowa" 앱을 사용한다
2. 사용자 B가 "app-b" 앱을 사용한다
3. 관리자가 "wowa" 앱에 공지사항을 작성한다
4. 시스템이 공지사항에 "wowa" 앱 코드를 저장한다
5. 사용자 A가 공지사항을 조회할 때 "wowa" 공지사항만 표시된다
6. 사용자 B가 공지사항을 조회할 때 "wowa" 공지사항은 표시되지 않는다
7. 결과: 각 앱의 공지사항이 독립적으로 관리되고 표시된다

---

## 인수 조건 (Acceptance Criteria)

### 사용자 기능
- [ ] 사용자는 자신이 사용하는 앱의 공지사항 목록을 조회할 수 있다
- [ ] 공지사항 목록은 고정된 공지사항을 상단에, 나머지는 최신순으로 표시한다
- [ ] 사용자는 공지사항의 읽음/읽지 않음 상태를 시각적으로 구분할 수 있다
- [ ] 사용자는 공지사항을 선택하여 전체 내용을 조회할 수 있다
- [ ] 공지사항 상세 조회 시 자동으로 읽음 처리된다
- [ ] 사용자는 읽지 않은 공지사항의 개수를 확인할 수 있다
- [ ] 공지사항 본문은 마크다운 형식으로 렌더링된다
- [ ] 공지사항 목록은 페이지네이션을 지원하여 대량의 데이터를 효율적으로 표시한다

### 관리자 기능
- [ ] 관리자는 공지사항을 작성할 수 있다
- [ ] 관리자는 작성한 공지사항을 수정할 수 있다
- [ ] 관리자는 공지사항을 삭제할 수 있다 (복구 가능)
- [ ] 관리자는 공지사항을 상단에 고정하거나 해제할 수 있다
- [ ] 관리자는 공지사항에 카테고리를 설정할 수 있다 (선택사항)
- [ ] 작성 시 제목과 본문은 필수 입력 항목이다
- [ ] 공지사항은 작성 시 자동으로 공개 상태가 된다

### 멀티테넌트
- [ ] 각 공지사항은 특정 앱에 속한다
- [ ] 사용자는 자신의 앱에 속한 공지사항만 조회할 수 있다
- [ ] 관리자는 자신이 관리하는 앱의 공지사항만 관리할 수 있다
- [ ] 앱 코드는 인증 시스템을 통해 자동으로 결정된다

---

## 엣지 케이스

- **공지사항이 하나도 없는 경우**: 빈 상태 메시지를 표시한다 ("아직 등록된 공지사항이 없습니다")
- **네트워크 오류 발생 시**: 사용자에게 연결 오류 메시지를 표시하고 재시도 옵션을 제공한다
- **공지사항 조회 중 삭제된 경우**: 404 에러 메시지를 표시하고 목록으로 돌아간다
- **동시에 여러 관리자가 같은 공지사항을 수정하는 경우**: 마지막 저장이 반영된다 (낙관적 동시성 제어 적용 안 함)
- **관리자가 아닌 사용자가 관리 기능에 접근하는 경우**: 권한 오류를 반환한다
- **읽음 처리가 실패하는 경우**: 조회는 정상적으로 이루어지되, 읽음 상태는 업데이트되지 않는다 (비치명적 오류)
- **고정 공지사항이 너무 많은 경우**: 모두 상단에 표시하되, 생성일시 역순으로 정렬한다
- **페이지네이션의 마지막 페이지인 경우**: 더 이상 데이터가 없음을 사용자에게 표시한다
- **본문에 유효하지 않은 마크다운이 포함된 경우**: 가능한 범위 내에서 렌더링하고, 나머지는 일반 텍스트로 표시한다
- **공지사항 제목이나 본문이 비정상적으로 긴 경우**: 목록에서는 제목을 잘라서 표시하고, 상세에서는 전체 내용을 스크롤로 표시한다

---

## 비즈니스 규칙

- **앱 격리**: 모든 공지사항은 특정 앱 코드에 속하며, 다른 앱의 데이터에 접근할 수 없다
- **읽음 상태**: 사용자별, 공지사항별로 독립적으로 관리된다 (동일한 공지사항을 여러 사용자가 각자의 읽음 상태를 가짐)
- **조회수 카운팅**: 공지사항 상세 조회 시마다 1씩 증가한다 (중복 조회 포함)
- **고정 우선순위**: 고정된 공지사항은 항상 일반 공지사항보다 위에 표시된다
- **삭제 정책**: 공지사항은 즉시 삭제되지 않고 삭제 마크만 표시되어 복구 가능하다
- **권한 분리**: 일반 사용자는 조회만 가능하고, 관리자만 작성/수정/삭제가 가능하다
- **자동 공개**: 공지사항 작성 시 별도 설정 없이 즉시 공개된다
- **정렬 순서**: 고정 공지사항 그룹과 일반 공지사항 그룹 내에서 각각 최신순으로 정렬한다
- **카테고리 자유도**: 카테고리는 선택사항이며, 미리 정의된 값 없이 자유롭게 입력 가능하다
- **본문 형식**: 본문은 마크다운 텍스트로 저장되고, 렌더링은 클라이언트에서 담당한다

---

## 필요한 데이터

### 공지사항 조회 (사용자 요청)
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| 페이지 번호 | 숫자 | ❌ | 페이지네이션용 (기본값: 1) |
| 페이지 크기 | 숫자 | ❌ | 한 페이지당 항목 수 (기본값: 20) |
| 카테고리 | 문자열 | ❌ | 특정 카테고리 필터링 |
| 고정만 보기 | 불리언 | ❌ | 고정 공지사항만 조회 |

### 공지사항 목록 응답 (시스템 반환)
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| 공지사항 목록 | 배열 | ✅ | 공지사항 요약 정보 목록 |
| 전체 개수 | 숫자 | ✅ | 전체 공지사항 수 |
| 다음 페이지 존재 여부 | 불리언 | ✅ | 페이지네이션 제어용 |

### 공지사항 요약 정보 (목록 아이템)
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| 공지사항 ID | 문자열 | ✅ | 고유 식별자 |
| 제목 | 문자열 | ✅ | 공지사항 제목 |
| 카테고리 | 문자열 | ❌ | 공지 유형 (업데이트, 점검 등) |
| 고정 여부 | 불리언 | ✅ | 상단 고정 여부 |
| 읽음 여부 | 불리언 | ✅ | 현재 사용자의 읽음 상태 |
| 조회수 | 숫자 | ✅ | 총 조회 횟수 |
| 작성일시 | 날짜/시간 | ✅ | 공지사항 작성 시각 |

### 공지사항 상세 정보 (상세 조회)
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| 공지사항 ID | 문자열 | ✅ | 고유 식별자 |
| 제목 | 문자열 | ✅ | 공지사항 제목 |
| 본문 | 문자열 | ✅ | 마크다운 형식 본문 |
| 카테고리 | 문자열 | ❌ | 공지 유형 |
| 고정 여부 | 불리언 | ✅ | 상단 고정 여부 |
| 조회수 | 숫자 | ✅ | 총 조회 횟수 |
| 작성자 정보 | 문자열 | ❌ | 작성자 ID 또는 이름 |
| 작성일시 | 날짜/시간 | ✅ | 공지사항 작성 시각 |
| 수정일시 | 날짜/시간 | ❌ | 마지막 수정 시각 |

### 읽지 않은 공지 개수 응답
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| 읽지 않은 개수 | 숫자 | ✅ | 사용자가 읽지 않은 공지사항 수 |

### 공지사항 작성 (관리자 요청)
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| 제목 | 문자열 | ✅ | 공지사항 제목 (1~200자) |
| 본문 | 문자열 | ✅ | 마크다운 형식 본문 |
| 카테고리 | 문자열 | ❌ | 공지 유형 (최대 50자) |
| 고정 여부 | 불리언 | ❌ | 상단 고정 여부 (기본값: false) |

### 공지사항 수정 (관리자 요청)
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| 공지사항 ID | 문자열 | ✅ | 수정할 공지사항 식별자 |
| 제목 | 문자열 | ❌ | 변경할 제목 |
| 본문 | 문자열 | ❌ | 변경할 본문 |
| 카테고리 | 문자열 | ❌ | 변경할 카테고리 |
| 고정 여부 | 불리언 | ❌ | 변경할 고정 상태 |

---

## 비기능 요구사항

### 성능
- 공지사항 목록 조회는 1초 이내에 응답한다 (100개 이하 기준)
- 공지사항 상세 조회는 500ms 이내에 응답한다
- 읽지 않은 개수 조회는 200ms 이내에 응답한다
- 페이지네이션을 통해 대량의 공지사항을 효율적으로 처리한다

### 접근성
- 읽지 않은 공지사항은 시각적으로 명확히 구분된다 (예: 굵은 글씨, 점 표시)
- 고정 공지사항은 일반 공지사항과 시각적으로 구분된다 (예: 핀 아이콘)
- 공지사항 없음 상태는 명확한 안내 메시지로 표시한다
- 로딩 상태를 사용자에게 표시한다

### 에러 처리
- 네트워크 오류: "인터넷 연결을 확인해주세요" 메시지 표시 및 재시도 옵션 제공
- 권한 오류: "이 기능을 사용할 권한이 없습니다" 메시지 표시
- 데이터 없음: "조회할 수 있는 공지사항이 없습니다" 메시지 표시
- 서버 오류: "일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요" 메시지 표시
- 삭제된 공지사항 조회 시: "삭제되었거나 존재하지 않는 공지사항입니다" 메시지 표시 후 목록으로 이동
- 입력 유효성 오류: 각 필드별 구체적인 오류 메시지 표시 (예: "제목을 입력해주세요", "본문은 필수입니다")

### 보안
- 모든 요청은 인증된 사용자만 접근 가능하다
- 관리자 기능(작성/수정/삭제)은 관리자 권한이 있는 사용자만 접근 가능하다
- 앱 코드는 클라이언트가 임의로 변경할 수 없으며, 서버에서 인증 토큰을 통해 결정한다
- 공지사항 조회 시 다른 앱의 데이터에 접근할 수 없다

### 확장성
- 새로운 앱이 추가되어도 코드 변경 없이 공지사항 기능을 사용할 수 있다
- 카테고리는 하드코딩되지 않고 자유롭게 추가할 수 있다
- 향후 예약 발행, 푸시 연동, 대상 지정 등의 기능을 추가할 수 있는 여지를 남긴다

### 데이터 무결성
- 삭제된 공지사항은 즉시 제거되지 않고 삭제 표시만 되어 복구 가능하다
- 읽음 상태는 사용자별로 독립적으로 관리되어 다른 사용자에게 영향을 주지 않는다
- 공지사항 조회수는 정확하지 않을 수 있으나 큰 문제는 없다 (비즈니스 크리티컬 데이터 아님)
