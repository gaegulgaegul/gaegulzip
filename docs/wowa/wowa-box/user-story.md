# 사용자 스토리: 박스 관리 기능 개선

## 개요
사용자가 크로스핏 박스를 더 쉽게 찾고, 안정적으로 생성할 수 있도록 개선합니다. 검색 경험을 단순화하고, 박스 생성 시 발생하는 오류를 수정하여 사용자 경험을 향상시킵니다.

## 사용자 스토리

### US-1: 통합 키워드 검색
- **As a** 크로스핏 운동을 하려는 사용자
- **I want to** 하나의 검색창에 키워드를 입력하여 박스를 찾을 수 있다
- **So that** 박스 이름과 지역을 따로 입력하지 않고 빠르게 원하는 박스를 찾을 수 있다

### US-2: 안정적인 박스 생성
- **As a** 박스 운영자
- **I want to** 새로운 박스를 생성할 때 오류 없이 성공적으로 등록할 수 있다
- **So that** 내 박스를 플랫폼에 등록하고 멤버를 모집할 수 있다

## 사용자 시나리오

### 시나리오 1: 통합 검색으로 박스 찾기 (정상 플로우)
1. 사용자가 박스 찾기 화면에 진입한다
2. 시스템이 하나의 검색 입력창을 보여준다
3. 사용자가 "강남 크로스핏" 또는 "CrossFit Seoul" 같은 키워드를 입력한다
4. 시스템이 입력된 키워드로 박스 이름과 지역을 동시에 검색한다
5. 시스템이 매칭되는 박스 목록을 표시한다 (박스 이름, 지역, 멤버 수 포함)
6. 결과: 사용자가 원하는 박스를 빠르게 찾을 수 있다

### 시나리오 2: 검색어가 없을 때
1. 사용자가 박스 찾기 화면에 진입한다
2. 시스템이 검색창을 보여주고, 검색어 입력을 안내한다
3. 사용자가 아무것도 입력하지 않는다
4. 결과: 시스템이 "박스를 검색해보세요" 같은 안내 메시지를 표시한다 (빈 목록 표시하지 않음)

### 시나리오 3: 검색 결과가 없을 때
1. 사용자가 "없는박스" 같은 키워드를 입력한다
2. 시스템이 박스 이름과 지역에서 키워드를 검색한다
3. 시스템이 매칭되는 결과를 찾지 못한다
4. 결과: 시스템이 "검색 결과가 없습니다" 메시지를 표시하고, "새 박스 만들기" 옵션을 제공한다

### 시나리오 4: 박스 생성 성공
1. 사용자가 "새 박스 만들기"를 선택한다
2. 시스템이 박스 생성 화면을 표시한다 (이름, 지역, 설명 입력)
3. 사용자가 박스 이름 "CrossFit Seoul", 지역 "서울 강남구"를 입력한다
4. 사용자가 "생성" 버튼을 누른다
5. 시스템이 박스를 생성하고, 사용자를 자동으로 해당 박스의 멤버로 등록한다
6. 결과: 사용자가 "박스가 생성되었습니다" 메시지를 보고, 홈 화면으로 이동한다

### 시나리오 5: 박스 생성 중 네트워크 오류
1. 사용자가 박스 생성 폼을 작성하고 "생성" 버튼을 누른다
2. 시스템이 서버에 요청을 보낸다
3. 네트워크 연결이 불안정하여 요청이 실패한다
4. 결과: 시스템이 "네트워크 연결을 확인해주세요" 오류 메시지를 표시하고, 사용자가 다시 시도할 수 있게 한다

### 시나리오 6: 이미 박스에 소속된 상태에서 새 박스 생성
1. 사용자가 이미 "CrossFit Seoul" 박스에 가입되어 있다
2. 사용자가 새로운 박스를 생성하려고 한다
3. 사용자가 박스 정보를 입력하고 "생성" 버튼을 누른다
4. 시스템이 박스를 생성하고, 사용자를 기존 박스에서 자동으로 탈퇴시킨 후, 새 박스에 가입시킨다 (단일 박스 정책)
5. 결과: 사용자가 새 박스의 멤버로 등록되고, "박스가 생성되었습니다" 메시지를 본다

## 인수 조건 (Acceptance Criteria)

### 통합 검색
- [ ] 사용자가 하나의 검색창에 키워드를 입력할 수 있다
- [ ] 시스템이 입력된 키워드로 박스 이름과 지역을 동시에 검색한다
- [ ] 검색 결과에 박스 이름, 지역, 설명, 멤버 수가 표시된다
- [ ] 검색어가 없으면 안내 메시지가 표시된다 (빈 목록 아님)
- [ ] 검색 결과가 없으면 "검색 결과가 없습니다" 메시지가 표시된다
- [ ] 검색어 입력 중 자동으로 검색이 실행된다 (타이핑 중단 후 짧은 지연 후)

### 박스 생성
- [ ] 사용자가 박스 이름, 지역을 필수로 입력할 수 있다
- [ ] 사용자가 박스 설명을 선택적으로 입력할 수 있다
- [ ] 박스 생성 성공 시 사용자가 자동으로 해당 박스의 멤버로 등록된다
- [ ] 박스 생성 성공 시 "박스가 생성되었습니다" 메시지가 표시된다
- [ ] 박스 생성 성공 시 홈 화면으로 이동한다
- [ ] 생성 중 오류 발생 시 명확한 오류 메시지가 표시된다
- [ ] 이미 박스에 소속된 상태에서 새 박스 생성 시 기존 박스에서 자동 탈퇴 후 새 박스에 가입된다 (단일 박스 정책)

## 엣지 케이스

- **매우 짧은 검색어**: 1자 검색어도 허용하고 결과를 표시한다 (서버에서 필터링)
- **매우 긴 검색어**: 검색어 길이 제한을 UI에서 명시하지 않지만, 서버에서 적절히 처리한다
- **특수문자 검색**: 사용자가 특수문자를 입력해도 시스템이 정상적으로 검색을 수행한다
- **박스 이름 중복**: 같은 이름의 박스가 여러 개 존재할 수 있다 (지역으로 구분)
- **빈 검색 결과에서 박스 생성**: 검색 결과가 없을 때 "새 박스 만들기"를 누르면 검색어가 박스 이름 필드에 자동 입력되지 않는다 (사용자가 직접 입력)
- **박스 생성 중 네트워크 끊김**: 생성 요청 중 네트워크가 끊기면 사용자에게 재시도 옵션을 제공한다
- **박스 생성 중 로그아웃**: 생성 중 토큰이 만료되면 로그인 화면으로 이동한다

## 비즈니스 규칙

- **단일 박스 정책**: 사용자는 한 번에 하나의 박스에만 소속될 수 있다. 새 박스에 가입하거나 생성하면 기존 박스에서 자동으로 탈퇴한다.
- **박스 생성자 자동 가입**: 박스를 생성한 사용자는 자동으로 해당 박스의 첫 번째 멤버로 등록된다.
- **검색 즉시성**: 검색어를 입력하는 동안 시스템이 자동으로 검색을 수행한다 (사용자가 검색 버튼을 누를 필요 없음).
- **검색 범위**: 검색 키워드는 박스 이름과 지역 양쪽에서 모두 매칭을 시도한다.
- **빈 검색 방지**: 검색어가 비어있으면 검색을 수행하지 않고 안내 메시지를 표시한다.

## 필요한 데이터

### 박스 검색 입력
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| keyword | 문자열 | ❌ | 통합 검색 키워드 (박스 이름 또는 지역) |

### 박스 검색 출력
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| boxes | 배열 | ✅ | 검색된 박스 목록 |
| box.id | 숫자 | ✅ | 박스 고유 ID |
| box.name | 문자열 | ✅ | 박스 이름 |
| box.region | 문자열 | ✅ | 박스 지역 |
| box.description | 문자열 | ❌ | 박스 설명 |
| box.memberCount | 숫자 | ✅ | 현재 멤버 수 |

### 박스 생성 입력
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| name | 문자열 | ✅ | 박스 이름 (2~255자) |
| region | 문자열 | ✅ | 박스 지역 (2~255자) |
| description | 문자열 | ❌ | 박스 설명 (최대 1000자) |

### 박스 생성 출력
| 데이터 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| box | 객체 | ✅ | 생성된 박스 정보 |
| box.id | 숫자 | ✅ | 박스 고유 ID |
| box.name | 문자열 | ✅ | 박스 이름 |
| box.region | 문자열 | ✅ | 박스 지역 |
| box.description | 문자열 | ❌ | 박스 설명 |
| membership | 객체 | ✅ | 자동 가입된 멤버십 정보 |
| membership.id | 숫자 | ✅ | 멤버십 ID |
| membership.joinedAt | 날짜시간 | ✅ | 가입 시간 |

## 비기능 요구사항

### 성능
- 검색 키워드 입력 후 300ms 이내에 검색이 시작되어야 한다 (타이핑 중단 감지)
- 검색 결과는 1초 이내에 표시되어야 한다
- 박스 생성 요청은 3초 이내에 완료되어야 한다

### 사용성
- 검색창의 플레이스홀더 텍스트가 검색 기능을 명확히 설명해야 한다 (예: "박스 이름이나 지역을 검색하세요")
- 로딩 중에는 사용자가 진행 상태를 알 수 있어야 한다 (로딩 인디케이터 표시)
- 오류 메시지는 사용자가 이해하기 쉽고, 해결 방법을 제시해야 한다

### 접근성
- 검색창은 키보드로 접근 가능해야 한다
- 검색 결과는 스크린 리더로 읽을 수 있어야 한다
- 버튼은 터치 가능한 최소 크기를 만족해야 한다

### 에러 처리
- **네트워크 오류**: "네트워크 연결을 확인해주세요"
- **인증 만료**: 로그인 화면으로 자동 이동
- **서버 오류**: "일시적인 문제가 발생했습니다. 잠시 후 다시 시도해주세요"
- **유효성 검증 실패**: 입력 필드 아래 구체적인 오류 메시지 표시 (예: "박스 이름은 2자 이상이어야 합니다")
- **박스 생성 실패**: 실패 원인을 명확히 알려주고, 사용자가 입력한 데이터가 유지되어야 한다
